<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Evaluaci√≥n en L√≠nea - Psic. Andr√©s Tello</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body { font-family: 'Poppins', sans-serif; background-color: #f4f7f6; margin: 0; padding: 20px; color: #333; }
        .container { max-width: 900px; margin: 0 auto; background: white; padding: 30px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
        
        h1 { text-align: center; color: #2c3e50; margin-bottom: 5px; }
        .subtitle { text-align: center; color: #7f8c8d; margin-bottom: 30px; font-size: 0.95rem; }

        /* PESTA√ëAS */
        .tabs { display: flex; justify-content: center; gap: 10px; margin-bottom: 25px; flex-wrap: wrap; }
        .tab-btn { 
            background: white; border: 2px solid #ecf0f1; padding: 10px 25px; cursor: pointer; 
            font-size: 1rem; color: #7f8c8d; font-weight: 600; border-radius: 50px; transition: all 0.3s;
        }
        .tab-btn:hover { border-color: #3498db; color: #3498db; }
        .tab-btn.active { background-color: #3498db; color: white; border-color: #3498db; box-shadow: 0 4px 10px rgba(52, 152, 219, 0.3); }
        
        .tab-content { display: none; animation: fadeIn 0.5s ease; }
        .tab-content.active { display: block; }

        /* TARJETAS DE TEST */
        .grid-tests { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }
        .test-card { background: #fff; border: 1px solid #e1e1e1; border-radius: 12px; padding: 25px; box-shadow: 0 2px 5px rgba(0,0,0,0.02); transition: transform 0.2s; }
        .test-card:hover { transform: translateY(-3px); box-shadow: 0 5px 15px rgba(0,0,0,0.08); }
        
        .test-header { display: flex; align-items: center; gap: 12px; margin-bottom: 15px; border-bottom: 1px solid #f0f0f0; padding-bottom: 10px; }
        .icon-box { width: 40px; height: 40px; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; color: white; }
        .test-title { font-size: 1.1rem; font-weight: 700; color: #2c3e50; margin: 0; }
        .test-desc { font-size: 0.85rem; color: #7f8c8d; margin-bottom: 20px; line-height: 1.5; }

        /* BOTONES INTERNOS */
        .btn-start { 
            display: block; width: 100%; padding: 10px; text-align: center; border: none; border-radius: 8px; 
            background-color: #f8f9fa; color: #2c3e50; font-weight: 600; cursor: pointer; transition: 0.3s;
        }
        .btn-start:hover { background-color: #e2e6ea; }
        
        /* √ÅREA DE PREGUNTAS (OCULTA AL INICIO) */
        .quiz-area { display: none; margin-top: 20px; border-top: 2px dashed #eee; padding-top: 20px; }
        .question-box { margin-bottom: 15px; padding: 15px; background: #fcfcfc; border-radius: 8px; border-left: 3px solid #3498db; }
        .question-text { font-weight: 500; margin-bottom: 10px; color: #444; }
        .options label { display: block; margin-bottom: 8px; cursor: pointer; font-size: 0.9rem; color: #666; }
        .options input { margin-right: 10px; }

        .btn-calc { 
            background-color: #27ae60; color: white; border: none; padding: 12px; width: 100%; 
            border-radius: 8px; font-size: 1rem; cursor: pointer; margin-top: 15px; font-weight: 600;
        }
        .btn-calc:hover { background-color: #219150; }

        /* RESULTADOS */
        .result-box { display: none; margin-top: 20px; animation: slideDown 0.4s ease; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }

        .btn-back { display: block; text-align: center; margin-top: 40px; color: #95a5a6; text-decoration: none; font-weight: 500; }
    </style>
</head>
<body>

<div class="container">
    <h1>üß† Centro de Evaluaci√≥n Integral</h1>
    <p class="subtitle">Selecciona el grupo de edad y elige el test que deseas realizar.</p>

    <div class="tabs">
        <button class="tab-btn active" onclick="openTab('adultos')"><i class="fas fa-user-tie"></i> Adultos</button>
        <button class="tab-btn" onclick="openTab('adolescentes')"><i class="fas fa-user-graduate"></i> Adolescentes</button>
        <button class="tab-btn" onclick="openTab('ninos')"><i class="fas fa-child"></i> Ni√±os (Padres)</button>
    </div>

    <div id="adultos" class="tab-content active">
        <div class="grid-tests">
            <div class="test-card">
                <div class="test-header"><div class="icon-box" style="background:#e67e22"><i class="fas fa-brain"></i></div> <h3 class="test-title">Ansiedad (GAD-7)</h3></div>
                <p class="test-desc">Eval√∫a s√≠ntomas de ansiedad generalizada, nerviosismo y preocupaci√≥n excesiva en las √∫ltimas 2 semanas.</p>
                <button class="btn-start" onclick="toggleTest('gad7')">Realizar Test ‚ñº</button>
                <div id="area-gad7" class="quiz-area">
                    <div id="form-gad7"></div>
                    <button class="btn-calc" onclick="calcularGAD7()">Ver Resultado</button>
                    <div id="res-gad7" class="result-box"></div>
                </div>
            </div>
            <div class="test-card">
                <div class="test-header"><div class="icon-box" style="background:#3498db"><i class="fas fa-cloud-rain"></i></div> <h3 class="test-title">Depresi√≥n (PHQ-9)</h3></div>
                <p class="test-desc">Screening est√°ndar para detectar s√≠ntomas depresivos, des√°nimo y p√©rdida de inter√©s.</p>
                <button class="btn-start" onclick="toggleTest('phq9')">Realizar Test ‚ñº</button>
                <div id="area-phq9" class="quiz-area">
                    <div id="form-phq9"></div>
                    <button class="btn-calc" onclick="calcularPHQ9()">Ver Resultado</button>
                    <div id="res-phq9" class="result-box"></div>
                </div>
            </div>
            <div class="test-card">
                <div class="test-header"><div class="icon-box" style="background:#f1c40f"><i class="fas fa-bolt"></i></div> <h3 class="test-title">TDAH Adultos (ASRS)</h3></div>
                <p class="test-desc">Escala de auto-reporte para identificar s√≠ntomas de d√©ficit de atenci√≥n e hiperactividad en la vida adulta.</p>
                <button class="btn-start" onclick="toggleTest('asrs')">Realizar Test ‚ñº</button>
                <div id="area-asrs" class="quiz-area">
                    <div id="form-asrs"></div>
                    <button class="btn-calc" onclick="calcularASRS()">Ver Resultado</button>
                    <div id="res-asrs" class="result-box"></div>
                </div>
            </div>
            <div class="test-card">
                <div class="test-header"><div class="icon-box" style="background:#9b59b6"><i class="fas fa-moon"></i></div> <h3 class="test-title">Insomnio (ISI)</h3></div>
                <p class="test-desc">√çndice de Severidad del Insomnio. Eval√∫a la calidad del sue√±o y su impacto en el d√≠a.</p>
                <button class="btn-start" onclick="toggleTest('isi')">Realizar Test ‚ñº</button>
                <div id="area-isi" class="quiz-area">
                    <div id="form-isi"></div>
                    <button class="btn-calc" onclick="calcularISI()">Ver Resultado</button>
                    <div id="res-isi" class="result-box"></div>
                </div>
            </div>
            <div class="test-card">
                <div class="test-header"><div class="icon-box" style="background:#e74c3c"><i class="fas fa-fire"></i></div> <h3 class="test-title">Estr√©s Percibido</h3></div>
                <p class="test-desc">Eval√∫a qu√© tan impredecible, incontrolable y sobrecargada siente su vida actualmente.</p>
                <button class="btn-start" onclick="toggleTest('pss')">Realizar Test ‚ñº</button>
                <div id="area-pss" class="quiz-area">
                    <div id="form-pss"></div>
                    <button class="btn-calc" onclick="calcularPSS()">Ver Resultado</button>
                    <div id="res-pss" class="result-box"></div>
                </div>
            </div>
        </div>
    </div>

    <div id="adolescentes" class="tab-content">
        <div class="grid-tests">
            <div class="test-card">
                <div class="test-header"><div class="icon-box" style="background:#9b59b6"><i class="fas fa-ghost"></i></div> <h3 class="test-title">Ansiedad (SCARED)</h3></div>
                <p class="test-desc">Detecta ansiedad generalizada, ansiedad social o miedos escolares en adolescentes.</p>
                <button class="btn-start" onclick="toggleTest('scared_a')">Realizar Test ‚ñº</button>
                <div id="area-scared_a" class="quiz-area">
                    <div id="form-scared_a"></div>
                    <button class="btn-calc" onclick="calcularSCARED_A()">Ver Resultado</button>
                    <div id="res-scared_a" class="result-box"></div>
                </div>
            </div>
            <div class="test-card">
                <div class="test-header"><div class="icon-box" style="background:#3498db"><i class="fas fa-sad-tear"></i></div> <h3 class="test-title">Depresi√≥n (PHQ-A)</h3></div>
                <p class="test-desc">Adaptaci√≥n para adolescentes. Eval√∫a irritabilidad, tristeza y problemas de sue√±o/apetito.</p>
                <button class="btn-start" onclick="toggleTest('phqa')">Realizar Test ‚ñº</button>
                <div id="area-phqa" class="quiz-area">
                    <div id="form-phqa"></div>
                    <button class="btn-calc" onclick="calcularPHQA()">Ver Resultado</button>
                    <div id="res-phqa" class="result-box"></div>
                </div>
            </div>
            <div class="test-card">
                <div class="test-header"><div class="icon-box" style="background:#2ecc71"><i class="fas fa-smile"></i></div> <h3 class="test-title">Autoestima</h3></div>
                <p class="test-desc">Escala de Rosenberg. Eval√∫a la satisfacci√≥n con uno mismo y el sentido de val√≠a personal.</p>
                <button class="btn-start" onclick="toggleTest('ros')">Realizar Test ‚ñº</button>
                <div id="area-ros" class="quiz-area">
                    <div id="form-ros"></div>
                    <button class="btn-calc" onclick="calcularROS()">Ver Resultado</button>
                    <div id="res-ros" class="result-box"></div>
                </div>
            </div>
            <div class="test-card">
                <div class="test-header"><div class="icon-box" style="background:#e74c3c"><i class="fas fa-bolt"></i></div> <h3 class="test-title">Nivel de Estr√©s</h3></div>
                <p class="test-desc">Cuestionario breve sobre presi√≥n escolar, expectativas y manejo de emociones.</p>
                <button class="btn-start" onclick="toggleTest('estres_a')">Realizar Test ‚ñº</button>
                <div id="area-estres_a" class="quiz-area">
                    <div id="form-estres_a"></div>
                    <button class="btn-calc" onclick="calcularEstresA()">Ver Resultado</button>
                    <div id="res-estres_a" class="result-box"></div>
                </div>
            </div>
             <div class="test-card">
                <div class="test-header"><div class="icon-box" style="background:#34495e"><i class="fas fa-bed"></i></div> <h3 class="test-title">Calidad de Sue√±o</h3></div>
                <p class="test-desc">Eval√∫a h√°bitos de sue√±o, uso de pantallas nocturno y descanso diurno.</p>
                <button class="btn-start" onclick="toggleTest('sueno_a')">Realizar Test ‚ñº</button>
                <div id="area-sueno_a" class="quiz-area">
                    <div id="form-sueno_a"></div>
                    <button class="btn-calc" onclick="calcularSuenoA()">Ver Resultado</button>
                    <div id="res-sueno_a" class="result-box"></div>
                </div>
            </div>
        </div>
    </div>

    <div id="ninos" class="tab-content">
        <div class="grid-tests">
            <div class="test-card">
                <div class="test-header"><div class="icon-box" style="background:#f1c40f"><i class="fas fa-puzzle-piece"></i></div> <h3 class="test-title">TDAH (Atenci√≥n)</h3></div>
                <p class="test-desc">Eval√∫a espec√≠ficamente dificultades para mantener la atenci√≥n, olvidos y desorganizaci√≥n.</p>
                <button class="btn-start" onclick="toggleTest('tdah_i')">Realizar Test ‚ñº</button>
                <div id="area-tdah_i" class="quiz-area">
                    <div id="form-tdah_i"></div>
                    <button class="btn-calc" onclick="calcularTDAH_I()">Ver Resultado</button>
                    <div id="res-tdah_i" class="result-box"></div>
                </div>
            </div>
            <div class="test-card">
                <div class="test-header"><div class="icon-box" style="background:#e67e22"><i class="fas fa-tachometer-alt"></i></div> <h3 class="test-title">TDAH (Hiperactividad)</h3></div>
                <p class="test-desc">Eval√∫a inquietud motora, impulsividad y dificultad para esperar turnos.</p>
                <button class="btn-start" onclick="toggleTest('tdah_h')">Realizar Test ‚ñº</button>
                <div id="area-tdah_h" class="quiz-area">
                    <div id="form-tdah_h"></div>
                    <button class="btn-calc" onclick="calcularTDAH_H()">Ver Resultado</button>
                    <div id="res-tdah_h" class="result-box"></div>
                </div>
            </div>
            <div class="test-card">
                <div class="test-header"><div class="icon-box" style="background:#c0392b"><i class="fas fa-angry"></i></div> <h3 class="test-title">Conducta (ODD)</h3></div>
                <p class="test-desc">Para evaluar conductas desafiantes, oposici√≥n a la autoridad y enfados frecuentes.</p>
                <button class="btn-start" onclick="toggleTest('odd')">Realizar Test ‚ñº</button>
                <div id="area-odd" class="quiz-area">
                    <div id="form-odd"></div>
                    <button class="btn-calc" onclick="calcularODD()">Ver Resultado</button>
                    <div id="res-odd" class="result-box"></div>
                </div>
            </div>
            <div class="test-card">
                <div class="test-header"><div class="icon-box" style="background:#9b59b6"><i class="fas fa-ghost"></i></div> <h3 class="test-title">Ansiedad (Padres)</h3></div>
                <p class="test-desc">Reporte de padres sobre miedos, preocupaciones y s√≠ntomas f√≠sicos de ansiedad en el ni√±o.</p>
                <button class="btn-start" onclick="toggleTest('scared_p')">Realizar Test ‚ñº</button>
                <div id="area-scared_p" class="quiz-area">
                    <div id="form-scared_p"></div>
                    <button class="btn-calc" onclick="calcularSCARED_P()">Ver Resultado</button>
                    <div id="res-scared_p" class="result-box"></div>
                </div>
            </div>
            <div class="test-card">
                <div class="test-header"><div class="icon-box" style="background:#3498db"><i class="fas fa-cloud-sun"></i></div> <h3 class="test-title">√Ånimo / Depresi√≥n</h3></div>
                <p class="test-desc">Eval√∫a si el ni√±o se muestra triste, retra√≠do, irritable o con cambios en el juego.</p>
                <button class="btn-start" onclick="toggleTest('dep_p')">Realizar Test ‚ñº</button>
                <div id="area-dep_p" class="quiz-area">
                    <div id="form-dep_p"></div>
                    <button class="btn-calc" onclick="calcularDEP_P()">Ver Resultado</button>
                    <div id="res-dep_p" class="result-box"></div>
                </div>
            </div>
        </div>
    </div>

    <a href="index.html" class="btn-back">‚Üê Volver al Inicio</a>
</div>

<script>
    const MI_NUMERO = "19086166835"; // Tu WhatsApp

    // === BANCO DE PREGUNTAS (15 TESTS) ===
    
    // ADULTOS
    const qGAD7 = ["Nerviosismo o ansiedad", "No poder controlar la preocupaci√≥n", "Preocupaci√≥n excesiva", "Dificultad para relajarse", "Inquietud motora", "Irritabilidad", "Miedo a algo terrible"];
    const qPHQ9 = ["Poco inter√©s/placer", "Des√°nimo/Tristeza", "Problemas sue√±o", "Cansancio", "Apetito (mucho/poco)", "Sentirse mal con uno mismo", "Dificultad concentraci√≥n", "Lentitud/Agitaci√≥n", "Pensamientos negativos"];
    const qASRS = ["Dificultad acabar detalles", "Dificultad ordenar cosas", "Olvida citas/obligaciones", "Evita tareas complejas", "Mueve manos/pies nervioso", "Se siente como un motor"];
    const qISI  = ["Dificultad conciliar sue√±o", "Dificultad mantener sue√±o", "Despertar muy temprano", "Insatisfacci√≥n con sue√±o", "Interfiere vida diaria", "Otros notan tu cansancio", "Preocupaci√≥n por sue√±o"];
    const qPSS  = ["Sentir que no controlas tu vida", "Sentir incapacidad manejar problemas", "Sentir que las cosas se acumulan", "Sentir que no puedes afrontar cambios"];

    // ADOLESCENTES
    const qSCARED_A = ["Me asusto sin raz√≥n", "Me duele la panza en la escuela", "Miedo a estar solo", "Miedo a dormir fuera", "Me preocupa el futuro", "Me cuesta respirar sin raz√≥n"];
    const qPHQA     = ["Me siento irritado/molesto", "No tengo ganas de nada", "Duermo mal", "Estoy muy cansado", "No tengo hambre o como mucho", "Me siento in√∫til", "No me concentro en clases"];
    const qROS      = ["Siento que soy una persona digna", "Siento que tengo buenas cualidades", "Soy capaz de hacer cosas bien", "Tengo una actitud positiva hacia m√≠", "Estoy satisfecho conmigo mismo"];
    const qESTRES_A = ["Me siento presionado por notas", "Tengo demasiadas actividades", "Discuto mucho en casa", "Siento que no cumplo expectativas", "Me siento agobiado"];
    const qSUENO_A  = ["Uso el celular hasta madrugada", "Me duermo en clases", "Me cuesta levantarme", "Siento que duermo poco", "Tengo pesadillas"];

    // NI√ëOS (PADRES)
    const qTDAH_I   = ["No presta atenci√≥n a detalles", "Le cuesta mantener la atenci√≥n", "Parece no escuchar", "No sigue instrucciones", "Pierde sus cosas", "Se distrae f√°cilmente"];
    const qTDAH_H   = ["Mueve manos/pies en asiento", "Se levanta en clases/mesa", "Corre o trepa excesivamente", "Tiene dificultad para jugar tranquilo", "Habla en exceso", "Interrumpe a otros"];
    const qODD      = ["Pierde la calma a menudo", "Discute con adultos", "Desaf√≠a las reglas", "Molesta a otros adrede", "Culpa a otros de sus errores", "Es rencoroso"];
    const qSCARED_P = ["Dice que se asusta sin raz√≥n", "Se queja de dolor de cabeza/panza", "No quiere separarse de usted", "Tiene miedo a dormir solo", "Se preocupa mucho"];
    const qDEP_P    = ["Se ve triste o llora mucho", "Ya no juega como antes", "Se queja de estar cansado", "Se irrita f√°cilmente", "Dice que nadie lo quiere"];

    // OPCIONES
    const optFrec = [{v:0,t:"Nunca"}, {v:1,t:"Varios d√≠as"}, {v:2,t:"M√°s de la mitad"}, {v:3,t:"Casi siempre"}];
    const optASRS = [{v:0,t:"Nunca"}, {v:1,t:"Rara vez"}, {v:2,t:"A veces"}, {v:3,t:"A menudo"}, {v:4,t:"Muy a menudo"}];
    const optSNAP = [{v:0,t:"Nada"}, {v:1,t:"Un poco"}, {v:2,t:"Bastante"}, {v:3,t:"Mucho"}];
    const optLikert = [{v:0,t:"Muy en desacuerdo"}, {v:1,t:"En desacuerdo"}, {v:2,t:"De acuerdo"}, {v:3,t:"Muy de acuerdo"}];

    // INICIALIZADOR DE TESTS
    function init() {
        // Adultos
        render("form-gad7", qGAD7, "g", optFrec);
        render("form-phq9", qPHQ9, "p", optFrec);
        render("form-asrs", qASRS, "a", optASRS);
        render("form-isi", qISI, "i", [{v:0,t:"Ninguna"},{v:1,t:"Leve"},{v:2,t:"Moderada"},{v:3,t:"Severa"},{v:4,t:"Muy Severa"}]);
        render("form-pss", qPSS, "pss", optFrec);
        
        // Adolescentes
        render("form-scared_a", qSCARED_A, "sca", optSNAP);
        render("form-phqa", qPHQA, "pqa", optFrec);
        render("form-ros", qROS, "ros", optLikert);
        render("form-estres_a", qESTRES_A, "esa", optSNAP);
        render("form-sueno_a", qSUENO_A, "sua", optSNAP);

        // Ni√±os
        render("form-tdah_i", qTDAH_I, "tdi", optSNAP);
        render("form-tdah_h", qTDAH_H, "tdh", optSNAP);
        render("form-odd", qODD, "odd", optSNAP);
        render("form-scared_p", qSCARED_P, "scp", optSNAP);
        render("form-dep_p", qDEP_P, "dpp", optSNAP);
    }

    // FUNCIONES DE INTERFAZ
    function render(id, qs, pre, opts) {
        let h = "";
        qs.forEach((q,i) => {
            h += `<div class="question-box"><p class="question-text">${i+1}. ${q}</p><div class="options">`;
            opts.forEach(o => h += `<label><input type="radio" name="${pre}${i}" value="${o.v}"> ${o.t}</label>`);
            h += `</div></div>`;
        });
        document.getElementById(id).innerHTML = h;
    }

    function openTab(name) {
        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(name).classList.add('active');
        event.currentTarget.classList.add('active');
    }

    function toggleTest(idSuffix) {
        const area = document.getElementById('area-' + idSuffix);
        const isHidden = area.style.display === 'none' || area.style.display === '';
        // Cerrar todos primero para limpieza visual (opcional)
        document.querySelectorAll('.quiz-area').forEach(d => d.style.display = 'none');
        if(isHidden) area.style.display = 'block';
    }

    // --- L√ìGICA DE C√ÅLCULO (DOBLE CANAL) ---
    
    // Adultos
    function calcularGAD7() { calcSum("g", qGAD7.length, 10, "Ansiedad Generalizada", "Posible Trastorno de Ansiedad (GAD-7 > 10)"); }
    function calcularPHQ9() { calcSum("p", qPHQ9.length, 10, "Depresi√≥n", "Posible Depresi√≥n Mayor (PHQ-9 > 10)"); }
    function calcularISI()  { calcSum("i", qISI.length, 15, "Insomnio Cl√≠nico", "Insomnio Cl√≠nico Moderado/Severo (ISI > 15)"); }
    function calcularPSS()  { calcSum("pss", qPSS.length, 8, "Estr√©s Percibido", "Nivel de Estr√©s Elevado"); }
    function calcularASRS() { 
        // ASRS criterio: 4 o m√°s √≠tems en zona gris (>=2)
        let r = countGray("a", qASRS.length, 2); 
        if(r.t<0) return;
        let pos = r.c >= 4;
        showResult("res-asrs", pos, "Indicadores de TDAH Adulto detectados.", "No se observan indicadores significativos.", `*ASRS TDAH* √çtems Positivos: ${r.c}/6. ${pos ? "‚ö†Ô∏è SCREENING POSITIVO" : "Negativo"}`);
    }

    // Adolescentes
    function calcularSCARED_A() { calcCount("sca", qSCARED_A.length, 1, 3, "Ansiedad Adolescente", "Riesgo de Ansiedad Elevado"); }
    function calcularPHQA()     { calcSum("pqa", qPHQA.length, 10, "Depresi√≥n Adolescente", "S√≠ntomas Depresivos Significativos"); }
    function calcularEstresA()  { calcCount("esa", qESTRES_A.length, 2, 3, "Estr√©s Escolar", "Sobrecarga de Estr√©s"); }
    function calcularSuenoA()   { calcCount("sua", qSUENO_A.length, 2, 3, "Higiene de Sue√±o", "Malos h√°bitos de sue√±o detectados"); }
    function calcularROS() {
        let t = sum("ros", qROS.length);
        if(t<0) return;
        let bajo = t <= 7; // Rango arbitrario para screening (0-15)
        let msg = bajo ? "Indicadores de baja autoestima." : "Nivel de autoestima saludable.";
        showResult("res-ros", bajo, msg, msg, `*AUTOESTIMA* Puntaje: ${t}/${qROS.length*3}. ${bajo ? "‚ö†Ô∏è BAJA" : "NORMAL"}`);
    }

    // Ni√±os
    function calcularTDAH_I() { calcCount("tdi", qTDAH_I.length, 2, 4, "TDAH Inatenci√≥n", "CUMPLE Criterio Inatenci√≥n"); } // Umbral ajustado screening
    function calcularTDAH_H() { calcCount("tdh", qTDAH_H.length, 2, 4, "TDAH Hiperactividad", "CUMPLE Criterio Hiperactividad"); }
    function calcularODD()    { calcCount("odd", qODD.length, 2, 4, "Conducta ODD", "CUMPLE Criterio Oposicionista"); }
    function calcularSCARED_P(){calcCount("scp", qSCARED_P.length, 1, 3, "Ansiedad (Padres)", "Indicadores de Ansiedad Infantil"); }
    function calcularDEP_P()  { calcCount("dpp", qDEP_P.length, 2, 3, "√Ånimo (Padres)", "Indicadores de Depresi√≥n Infantil"); }


    // UTILS GEN√âRICOS
    function sum(pre, n) { let s=0; for(let i=0;i<n;i++){ let el=document.querySelector(`input[name="${pre}${i}"]:checked`); if(!el){alert("Responde todo"); return -1;} s+=parseInt(el.value); } return s; }
    
    function countGray(pre, n, cut) { 
        let c=0; 
        for(let i=0;i<n;i++){ 
            let el=document.querySelector(`input[name="${pre}${i}"]:checked`); 
            if(!el){alert("Responde todo"); return {t:-1};} 
            if(parseInt(el.value)>=cut) c++; 
        } 
        return {c, t:0}; 
    }

    function calcSum(pre, n, cut, title, techMsg) {
        let t = sum(pre, n);
        if(t<0) return;
        let pos = t >= cut;
        showResult("res-"+pre.replace(/_/g,''), pos, "Se observan indicadores significativos que requieren atenci√≥n.", "Resultados dentro del rango esperado.", `*${title}* Puntaje: ${t}. ${pos ? "‚ö†Ô∏è " + techMsg : "Sin riesgo cl√≠nico."}`);
    }

    function calcCount(pre, n, valCut, countCut, title, techMsg) {
        let r = countGray(pre, n, valCut);
        if(r.t<0) return;
        let pos = r.c >= countCut;
        showResult("res-"+pre.replace(/_/g,''), pos, "Se detectaron indicadores que sugieren la necesidad de una evaluaci√≥n.", "No se detectaron indicadores de riesgo.", `*${title}* S√≠ntomas: ${r.c}/${n}. ${pos ? "‚ö†Ô∏è " + techMsg : "Negativo"}`);
    }

    function showResult(id, isRisk, msgRisk, msgOk, techText) {
        const div = document.getElementById(id);
        const color = isRisk ? "#e74c3c" : "#27ae60"; // Rojo o Verde
        div.innerHTML = `
            <div style="padding:15px; border-left:5px solid ${color}; background:${color}10; margin-top:15px; border-radius:8px;">
                <h4 style="color:${color}; margin:0 0 10px 0;">${isRisk ? "‚ö†Ô∏è Atenci√≥n Requerida" : "‚úÖ Resultado Normal"}</h4>
                <p>${isRisk ? msgRisk : msgOk}</p>
                <a href="https://wa.me/${MI_NUMERO}?text=${encodeURIComponent(techText)}" target="_blank" 
                   style="display:block; text-align:center; background:#25D366; color:white; padding:12px; border-radius:50px; text-decoration:none; margin-top:15px; font-weight:bold; box-shadow:0 3px 6px rgba(0,0,0,0.1);">
                   <i class="fab fa-whatsapp"></i> Enviar a Psic. Andr√©s
                </a>
            </div>`;
        div.style.display = "block";
        div.scrollIntoView({behavior:'smooth'});
    }

    // Inicializar al cargar
    init();
</script>

</body>
</html>