<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Evaluaci√≥n en L√≠nea - Psic. Andr√©s Tello</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body { font-family: 'Poppins', sans-serif; background-color: #f4f7f6; margin: 0; padding: 20px; color: #333; }
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 30px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
        
        h1 { text-align: center; color: #2c3e50; }
        .tabs { display: flex; justify-content: center; margin-bottom: 20px; border-bottom: 2px solid #eee; }
        .tab-btn { background: none; border: none; padding: 15px 25px; cursor: pointer; font-size: 1rem; color: #777; font-weight: 600; }
        .tab-btn.active { color: #3498db; border-bottom: 3px solid #3498db; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }

        .test-card { background: #fff; border: 1px solid #e1e1e1; border-radius: 10px; padding: 20px; margin-bottom: 20px; }
        .test-title { font-size: 1.2rem; color: #2c3e50; display: flex; align-items: center; gap: 10px; margin-bottom: 10px; }
        .btn-calc { background-color: #27ae60; color: white; border: none; padding: 12px; width: 100%; border-radius: 8px; font-size: 1rem; cursor: pointer; margin-top: 15px; }
        .btn-calc:hover { background-color: #219150; }
        
        .question-box { margin-bottom: 15px; padding: 10px; background: #f9f9f9; border-radius: 8px; }
        .options label { margin-right: 15px; cursor: pointer; display: inline-block; padding: 5px; }
        
        .result-box { display: none; margin-top: 20px; animation: fadeIn 0.5s ease; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* Bot√≥n volver */
        .btn-back { display: block; text-align: center; margin-top: 20px; color: #7f8c8d; text-decoration: none; }
    </style>
</head>
<body>

<div class="container">
    <h1>üìù Centro de Evaluaci√≥n</h1>
    <p style="text-align: center; color: #666; margin-bottom: 30px;">Selecciona la categor√≠a para ver los tests disponibles.</p>

    <div class="tabs">
        <button class="tab-btn active" onclick="openTab('adultos')">üë® Adultos</button>
        <button class="tab-btn" onclick="openTab('ninos')">üß∏ Ni√±os (Padres)</button>
    </div>

    <div id="adultos" class="tab-content active">
        
        <div class="test-card">
            <div class="test-title"><i class="fas fa-brain" style="color:#e67e22;"></i> GAD-7 (Ansiedad Generalizada)</div>
            <p>Durante las √∫ltimas 2 semanas, ¬øqu√© tan seguido ha tenido molestias por lo siguiente?</p>
            <div id="form-gad7"></div>
            <button class="btn-calc" onclick="calcularGAD7()">Calcular Resultado</button>
            <div id="res-gad7" class="result-box"></div>
        </div>

        <div class="test-card">
            <div class="test-title"><i class="fas fa-cloud-rain" style="color:#3498db;"></i> PHQ-9 (Depresi√≥n)</div>
            <p>Durante las √∫ltimas 2 semanas, ¬øqu√© tan seguido ha tenido molestias por lo siguiente?</p>
            <div id="form-phq9"></div>
            <button class="btn-calc" onclick="calcularPHQ9()">Calcular Resultado</button>
            <div id="res-phq9" class="result-box"></div>
        </div>

    </div>

    <div id="ninos" class="tab-content">
        
        <div class="test-card">
            <div class="test-title"><i class="fas fa-bolt" style="color:#f1c40f;"></i> TDAH (Inatenci√≥n)</div>
            <p>Instrucciones: Marque si el ni√±o/a presenta estas conductas a menudo.</p>
            <div id="form-tdah"></div>
            <button class="btn-calc" onclick="calcularTDAH()">Calcular Resultado</button>
            <div id="res-tdah" class="result-box"></div>
        </div>

        <div class="test-card">
            <div class="test-title"><i class="fas fa-ghost" style="color:#9b59b6;"></i> SCARED (Ansiedad Infantil)</div>
            <p>Instrucciones: ¬øSu hijo/a se queja de lo siguiente?</p>
            <div id="form-scared"></div>
            <button class="btn-calc" onclick="calcularSCARED()">Calcular Resultado</button>
            <div id="res-scared" class="result-box"></div>
        </div>

        <div class="test-card">
            <div class="test-title"><i class="fas fa-angry" style="color:#e74c3c;"></i> ODD (Conducta Desafiante)</div>
            <p>Instrucciones: Marque con qu√© frecuencia ocurren estas conductas.</p>
            <div id="form-odd"></div>
            <button class="btn-calc" onclick="calcularODD()">Calcular Resultado</button>
            <div id="res-odd" class="result-box"></div>
        </div>

    </div>

    <a href="index.html" class="btn-back">‚Üê Volver al Inicio</a>
</div>

<script>
    // --- CONFIGURACI√ìN ---
    const MI_NUMERO = "19086166835"; // Tu n√∫mero de WhatsApp

    // --- DATOS DE PREGUNTAS ---
    
    // 1. GAD-7 (Adultos)
    const qGAD7 = [
        "Sentirse nervioso/a, intranquilo/a o con los nervios de punta",
        "No poder dejar de preocuparse o no poder controlar la preocupaci√≥n",
        "Preocuparse demasiado por diferentes cosas",
        "Dificultad para relajarse",
        "Estar tan inquieto/a que es dif√≠cil estarse quieto/a",
        "Molestarse o irritarse f√°cilmente",
        "Tener miedo de que algo terrible vaya a pasar"
    ];

    // 2. PHQ-9 (Adultos)
    const qPHQ9 = [
        "Tener poco inter√©s o placer en hacer las cosas",
        "Sentirse desanimado/a, deprimido/a o sin esperanza",
        "Problemas para dormir o mantenerse dormido/a, o dormir demasiado",
        "Sentirse cansado/a o tener poca energ√≠a",
        "Tener poco apetito o comer en exceso",
        "Sentir falta de amor propio o que ha fallado a s√≠ mismo/a",
        "Dificultad para concentrarse en cosas (leer, ver TV)",
        "Moverse o hablar tan lento que otros lo notan, o estar muy inquieto",
        "Pensamientos de que estar√≠a mejor muerto/a o de lastimarse"
    ];

    // 3. TDAH (Ni√±os - SNAP-IV Inatenci√≥n)
    const qTDAH = [
        "No presta atenci√≥n a los detalles o comete errores por descuido",
        "Tiene dificultad para mantener la atenci√≥n en tareas o juegos",
        "Parece no escuchar cuando se le habla directamente",
        "No sigue instrucciones y no termina las tareas escolares",
        "Tiene dificultad para organizar tareas y actividades",
        "Evita tareas que requieren esfuerzo mental sostenido",
        "Pierde cosas necesarias para tareas (l√°pices, libros)",
        "Se distrae f√°cilmente por est√≠mulos externos",
        "Olvida las actividades cotidianas"
    ];

    // 4. SCARED (Ni√±os - Ansiedad)
    const qSCARED = [
        "Se asusta o pone nervioso sin raz√≥n aparente",
        "Tiene dolores de cabeza o est√≥mago cuando va a la escuela",
        "Tiene miedo de estar solo o sin sus padres",
        "Le da miedo dormir fuera de casa",
        "Se preocupa excesivamente por el futuro"
    ];

    // 5. ODD (Ni√±os - Conducta)
    const qODD = [
        "A menudo pierde la calma",
        "A menudo discute con los adultos",
        "Desaf√≠a activamente las reglas",
        "Molesta a los dem√°s deliberadamente",
        "Culpa a otros de sus errores",
        "Es susceptible o se molesta f√°cilmente",
        "Est√° enfadado o resentido",
        "Es rencoroso o vengativo"
    ];

    // --- OPCIONES DE RESPUESTA ---
    const optFrecuencia = [
        {val: 0, txt: "Nunca"},
        {val: 1, txt: "Varios d√≠as"},
        {val: 2, txt: "M√°s de la mitad"},
        {val: 3, txt: "Casi todos los d√≠as"}
    ];
    
    const optSNAP = [
        {val: 0, txt: "Nada"},
        {val: 1, txt: "Un poco"},
        {val: 2, txt: "Bastante"},
        {val: 3, txt: "Mucho"}
    ];

    // --- RENDERIZADOR ---
    function renderPreguntas(idDiv, preguntas, prefijo, opciones) {
        let html = "";
        preguntas.forEach((p, index) => {
            html += `<div class="question-box"><p><strong>${index + 1}.</strong> ${p}</p><div class="options">`;
            opciones.forEach(opt => {
                html += `<label><input type="radio" name="${prefijo}${index}" value="${opt.val}"> ${opt.txt}</label>`;
            });
            html += `</div></div>`;
        });
        document.getElementById(idDiv).innerHTML = html;
    }

    // Inicializar Tests
    renderPreguntas("form-gad7", qGAD7, "gad", optFrecuencia);
    renderPreguntas("form-phq9", qPHQ9, "phq", optFrecuencia);
    renderPreguntas("form-tdah", qTDAH, "tdah", optSNAP);
    renderPreguntas("form-scared", qSCARED, "scared", optSNAP);
    renderPreguntas("form-odd", qODD, "odd", optSNAP);

    // --- PESTA√ëAS ---
    function openTab(tabName) {
        document.querySelectorAll('.tab-content').forEach(x => x.classList.remove('active'));
        document.querySelectorAll('.tab-btn').forEach(x => x.classList.remove('active'));
        document.getElementById(tabName).classList.add('active');
        event.currentTarget.classList.add('active');
    }

    // --- FUNCIONES DE C√ÅLCULO ---

    // 1. GAD-7
    function calcularGAD7() {
        let total = sumarPuntos("gad", qGAD7.length);
        if(total === -1) return;
        
        let severidad = total <= 4 ? "M√≠nima" : total <= 9 ? "Leve" : total <= 14 ? "Moderada" : "Severa";
        let color = total >= 10 ? "#e74c3c" : "#27ae60";
        
        let msgPaciente = total >= 10 
            ? "Tus respuestas indican s√≠ntomas de ansiedad significativos. Es importante evaluarlo profesionalmente." 
            : "Tus niveles de ansiedad parecen estar bajo control.";
            
        let msgTecnico = `*RESULTADO GAD-7*%0A‚Ä¢ Puntaje: ${total}/21%0A‚Ä¢ Nivel: ${severidad}%0A‚Ä¢ Interpretaci√≥n: Posible Trastorno de Ansiedad Generalizada si >10.`;
        
        mostrarResultado("res-gad7", msgPaciente, color, msgTecnico);
    }

    // 2. PHQ-9
    function calcularPHQ9() {
        let total = sumarPuntos("phq", qPHQ9.length);
        if(total === -1) return;

        let severidad = total <= 4 ? "M√≠nima" : total <= 9 ? "Leve" : total <= 14 ? "Moderada" : total <= 19 ? "Moderada-Severa" : "Severa";
        let color = total >= 10 ? "#e74c3c" : "#27ae60";

        let msgPaciente = total >= 10
            ? "Hemos detectado indicadores importantes en tu estado de √°nimo. Te recomendamos agendar una consulta."
            : "Tu estado de √°nimo parece estable en este momento.";

        let msgTecnico = `*RESULTADO PHQ-9*%0A‚Ä¢ Puntaje: ${total}/27%0A‚Ä¢ Nivel: ${severidad}%0A‚Ä¢ Interpretaci√≥n: Valorar depresi√≥n mayor si >10.`;

        mostrarResultado("res-phq9", msgPaciente, color, msgTecnico);
    }

    // 3. TDAH
    function calcularTDAH() {
        let {total, clinicos} = contarSintomas("tdah", qTDAH.length, 2); // Umbral 2 (Bastante/Mucho)
        if(total === -1) return;
        
        let cumple = clinicos >= 6;
        let color = cumple ? "#f39c12" : "#27ae60";
        
        let msgPaciente = cumple
            ? "Se observan indicadores de inatenci√≥n que merecen una revisi√≥n profesional."
            : "No se observan indicadores significativos de d√©ficit de atenci√≥n.";
            
        let msgTecnico = `*RESULTADO TDAH (Inatenci√≥n)*%0A‚Ä¢ S√≠ntomas Cl√≠nicos: ${clinicos}/9%0A‚Ä¢ Criterio DSM-5: ${cumple ? "CUMPLE" : "NO CUMPLE"} (Umbral 6).`;
        
        mostrarResultado("res-tdah", msgPaciente, color, msgTecnico);
    }

    // 4. SCARED
    function calcularSCARED() {
        let {total, clinicos} = contarSintomas("scared", qSCARED.length, 1); // Umbral 1 (Un poco cuenta)
        if(total === -1) return;

        let positivo = total >= 3;
        let color = positivo ? "#f39c12" : "#27ae60";
        
        let msgPaciente = positivo
            ? "Tus respuestas sugieren presencia de ansiedad. Ser√≠a √∫til conversar sobre esto."
            : "Niveles de ansiedad dentro del rango esperado.";

        let msgTecnico = `*RESULTADO SCARED (Screening)*%0A‚Ä¢ √çtems Positivos: ${total}%0A‚Ä¢ Interpretaci√≥n: ${positivo ? "RIESGO" : "BAJO RIESGO"}.`;

        mostrarResultado("res-scared", msgPaciente, color, msgTecnico);
    }

    // 5. ODD
    function calcularODD() {
        let {total, clinicos} = contarSintomas("odd", qODD.length, 2);
        if(total === -1) return;

        let cumple = clinicos >= 4;
        let color = cumple ? "#c0392b" : "#27ae60";

        let msgPaciente = cumple
            ? "Se identifican patrones de conducta desafiante que requieren atenci√≥n."
            : "Conducta dentro de los l√≠mites esperados.";

        let msgTecnico = `*RESULTADO ODD (Conducta)*%0A‚Ä¢ S√≠ntomas Cl√≠nicos: ${clinicos}/8%0A‚Ä¢ Criterio DSM-5: ${cumple ? "CUMPLE" : "NO CUMPLE"} (Umbral 4).`;

        mostrarResultado("res-odd", msgPaciente, color, msgTecnico);
    }

    // --- UTILIDADES ---
    function sumarPuntos(prefijo, cantidad) {
        let suma = 0;
        for(let i=0; i<cantidad; i++) {
            let els = document.getElementsByName(`${prefijo}${i}`);
            let val = -1;
            for(let el of els) if(el.checked) val = parseInt(el.value);
            if(val === -1) { alert("Por favor responde todas las preguntas."); return -1; }
            suma += val;
        }
        return suma;
    }

    function contarSintomas(prefijo, cantidad, umbral) {
        let total = 0;
        let clinicos = 0;
        for(let i=0; i<cantidad; i++) {
            let els = document.getElementsByName(`${prefijo}${i}`);
            let val = -1;
            for(let el of els) if(el.checked) val = parseInt(el.value);
            if(val === -1) { alert("Responde todo por favor."); return {total:-1}; }
            total += val;
            if(val >= umbral) clinicos++;
        }
        return {total, clinicos};
    }

    function mostrarResultado(idDiv, textoPaciente, color, textoTecnico) {
        const div = document.getElementById(idDiv);
        div.innerHTML = `
            <div style="padding: 15px; border-left: 5px solid ${color}; background: ${color}10;">
                <h3 style="color:${color}; margin:0;">üìä Resultado</h3>
                <p>${textoPaciente}</p>
                <a href="https://wa.me/${MI_NUMERO}?text=${textoTecnico}" target="_blank" 
                   style="display:block; text-align:center; background:#25D366; color:white; padding:10px; border-radius:20px; text-decoration:none; margin-top:10px; font-weight:bold;">
                   <i class="fab fa-whatsapp"></i> Enviar An√°lisis al Psic√≥logo
                </a>
            </div>
        `;
        div.style.display = "block";
    }
</script>

</body>
</html>